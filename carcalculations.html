<!DOCTYPE HTML>
<html>
<head>
<title>Automotive Calculations</title>
  <link rel="stylesheet" href="./stylesheets/base.css" type="text/css">
  <script>
////////////////////////////////////////////////////////////////////////////////
  function gearratio() {
    "use strict"
    var intRPM;
    var intGears;
    var realTire;
    var realRear;
    var intDistanceInch = 12;
    var intDistanceFoot = 5280;
    var intDistanceKilometers = 1000000;
    var intTime = 60;
    var intCounter;
    var objTrannyTable;

    intGears = document.getElementById("gears").value;
    intRPM = document.getElementById("rpm").value;
    realRear = document.getElementById("gear").value;
    realTire = document.getElementById("tire").value;


//grab the trannytable then pull each individual gear ratio?
    objTrannyTable = document.getElementById("trannytable");

    intCounter = objTrannyTable.rows.length - 1;
    while (intCounter > 0){
      switch (document.getElementById("MeasureSystem").value){
        case "english":
//Basic formula that takes the diameter of a wheel, determines the circumfres and finally multiplys the circumfres by the rotaion speed.  Then the rotation speed is divided by to get milaege.
          objTrannyTable.rows[(parseInt(intCounter))].cells[2].children[0].value = Math.round(intRPM / (objTrannyTable.rows[(parseInt(intCounter))].cells[1].children[0].value * realRear) * (Math.PI * realTire) /intDistanceInch/intDistanceFoot*intTime);
          intCounter = intCounter - 1;
          break;
        case "metric":
//Same formula as before but for metric calculation.  This was the best way I could come up to deal with the two different measurement systems.  Maybe I can get this down to a single linne.
          objTrannyTable.rows[(parseInt(intCounter))].cells[2].children[0].value = Math.round(intRPM / (objTrannyTable.rows[(parseInt(intCounter))].cells[1].children[0].value * realRear) * (Math.PI * realTire) /intDistanceKilometers*intTime);
          intCounter = intCounter - 1;
          break;
      }
    }
  }
////////////////////////////////////////////////////////////////////////////////

  function gearchoice() {
    "use strict"
    var intI;
    var intGears;
    var holder;
    var objTrannyTable;
    var gearchoice;
    var objTableRow;
    intGears = parseInt(document.getElementById("gears").value, 10) + 1;

    objTrannyTable = document.getElementById("trannytable");
    if (objTrannyTable.rows.length < intGears){
      intI = intGears - objTrannyTable.rows.length;
      while (intI > 0) {
        objTableRow = objTrannyTable.insertRow(-1);
        holder = objTableRow.insertCell(0);
        holder.innerHTML = objTableRow.rowIndex;
        holder =  objTableRow.insertCell(1);
        holder.innerHTML =  "<input type=\"number\" step=\"0.01\" onchange=\"gearratio()\">";
        holder = objTableRow.insertCell(2);
        holder.innerHTML =  "<input type=\"number\" id=\"speed\">";
        intI = intI - 1;
        }
      }
    if (objTrannyTable.rows.length > intGears){
      intI = objTrannyTable.rows.length - intGears;
      while (intI > 0){
        objTrannyTable.deleteRow(-1);
        intI = intI - 1;
      }
    }
///////////////////////////////////////////////////////////////////////////////
  }
</script>
</head>
<body onload="gearchoice()">
  <form>
    <p>
      Gear ratio and speed calculator.
    </p>
    <p>
      By William, Victor and Daddy Warnock.
    </p>
    <p>Number of transmission gears <input id="gears" type="Range" min="1" max="10" onchange="gearchoice()"></p>
    <div>
      <table id="trannytable">
  <!--     <caption>Please enter the associated gear ratios for your transmission.</caption> -->
        <thead>
	        <tr><th>Gear</th><th>Ratio</th><th>Speed</th></tr>
        </thead>
        <tbody>
        </tbody>
      </table>
    </div>

    <p>Engine RPM <input id="rpm" type="number" min=0 required onchange="gearratio()"></p>
    <p>Rear end gear ratio <input id="gear" type="number" min=0 step=0.01  required onchange="gearratio()"></p>
    <p>Tire diamer (in inches)<input id="tire" type="number" min=0 step=0.1 required onchange="gearratio()"></p>
<p>
    <select id="MeasureSystem" onchange="gearratio()">
      <option value="english">U.S.</option>
      <option value="metric">Metric</option>
    </select>
 </P>
    <!-- <div>Estimated speed: <div id="stuff"></div></div> -->
<!--    <div id="junk"></div> -->
  </form>

  <p>
    This program will calculate the speed of a vehicle for every gear.  If you have a transaxle use 1 for the rear end ratio.
  </p>
  <p>
    All of this is programmed by hand and every attempt is made to have it support a standard web browser that can support <a href="http://www.w3.org/TR/html5/HTML5">html5</a> and <a href="https://www.ecma-international.org/publications/standards/Ecma-262.htm">ECMA Script</a>.
  </p>
  <!--http://www.offroaders.com/technical/p-metric-tire-sizes-p-metric-to-inches-conversion-chart/ -->
<div id="Test"></div>
</body>
</html>
